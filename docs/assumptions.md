# Принятые допущения

## Базовые

* В БД не ограничивается количество назначенных ревьюверов, но на уровне бизнес-логики контролируется максимум в два ревьювера на PR.
* Неактивные пользователи (`is_active = false`) не назначаются на новые ревью, но остаются в текущих назначениях и участвуют в чтении.
* Операция merge PR реализована как идемпотентная: повторные вызовы возвращают текущее состояние PR (как того требует условие).

## Авторизация

> Версия без авторризации - ветка `no-auth`

* Так реализация ограниченна временем выполнения для упрощённой авторизации сервис использует два фиксированных токена из переменных окружения:
  * `ADMIN_TOKEN` — передаётся в заголовке `X-Admin-Token` и даёт права администратора.
  * `USER_TOKEN`  — передаётся в заголовке `X-User-Token` и даёт права обычного пользователя.
  Реальной регистрации/логина нет.

* В оригинальной OpenAPI-спецификации авторизация была описанна не консистентно.
  Для демонстрации базовой авторизации я расширил спецификацию:
  добавлены схемы `AdminToken` и `UserToken`, а также требования по наличию токенов
  для эндпоинтов управления пользователями, PR и командами.

* Права доступа выбраны следующим образом:
  * `POST /team/add` — доступен только администратору (создание и изменение команд).
  * `GET /team/get` — доступен администратору и пользователю.
  * `POST /users/setIsActive` — только администратор.
  * `GET /users/getReview` — администратор или пользователь.
  * Все операции над PR (`/pullRequest/create`, `/pullRequest/merge`, `/pullRequest/reassign`) — только администратор.

* При ошибке авторизации сервис возвращает HTTP-статус `401` и JSON в формате `ErrorResponse`
  с кодом ошибки `BAD_REQUEST`. Это сделано для того, чтобы не вводить дополнительные коды ошибок
  по сравнению с исходной схемой (`ErrorResponse.code`), но при этом явно сигнализировать об ошибке авторизации
  через HTTP-статус.
